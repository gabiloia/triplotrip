import{d as b,r as v,E as k,i as E,a as p,w as s,b as i,g as n,u as d,B as w,f as g,x as N,o as P,c as m,F as x,e as T,h as j,t as C,p as B,N as D,_ as F}from"./G6QKWTEq.js";import{N as $}from"./GviZQag8.js";import"./DajhfOah.js";import"./BRZug4yH.js";const U={class:"space-y-4"},M={class:"flex justify-end gap-2 mt-4"},S=b({__name:"ModalEditarPropiedad",props:{show:{type:Boolean},propiedad:{}},emits:["update:show","guardar"],setup(y,{emit:l}){const u=y,c=l,o=v({});k(()=>u.propiedad,r=>{o.value={...r}},{immediate:!0});async function f(){try{if(!(await fetch(`http://localhost:1337/api/propiedades/${o.value.documentId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:{Titulo:o.value.Titulo,Descripcion:o.value.Descripcion}})})).ok)throw new Error("Error al guardar en Strapi");const e=await(await fetch(`http://localhost:1337/api/propiedades/${o.value.documentId}?populate=FotoPrincipal`)).json(),t={...e.data,...e.data.attributes,documentId:o.value.documentId};c("guardar",t),c("update:show",!1)}catch(r){console.error("Error al guardar cambios:",r)}}return(r,a)=>(p(),E(d(N),{show:r.show,preset:"dialog",title:"Editar Propiedad","onUpdate:show":a[3]||(a[3]=e=>r.$emit("update:show",e))},{action:s(()=>[i("div",M,[n(d(w),{onClick:a[2]||(a[2]=e=>r.$emit("update:show",!1))},{default:s(()=>a[4]||(a[4]=[g("Cancelar")])),_:1}),n(d(w),{type:"primary",onClick:f},{default:s(()=>a[5]||(a[5]=[g("Guardar")])),_:1})])]),default:s(()=>[i("div",U,[n(d($),{value:o.value.Titulo,"onUpdate:value":a[0]||(a[0]=e=>o.value.Titulo=e),placeholder:"Título"},null,8,["value"]),n(d($),{value:o.value.Descripcion,"onUpdate:value":a[1]||(a[1]=e=>o.value.Descripcion=e),type:"textarea",placeholder:"Descripción",rows:"4"},null,8,["value"])])]),_:1},8,["show"]))}}),V={class:"page"},G={class:"masonry"},L=["src"],z={class:"flex items-center justify-between"},J="tabler:edit",O=b({__name:"Propiedades",setup(y){const l=v([]),u=v(!1),c=v(null);function o(a){var t,h,_,I;const e=((_=(h=(t=a.FotoPrincipal)==null?void 0:t.formats)==null?void 0:h.medium)==null?void 0:_.url)||((I=a.FotoPrincipal)==null?void 0:I.url);return e?`http://localhost:1337${e}`:null}function f(a){c.value=a,u.value=!0}function r(a){const e=l.value.findIndex(t=>t.documentId===a.documentId);e!==-1&&(l.value[e]={...a})}return P(async()=>{try{const e=await(await fetch("http://localhost:1337/api/propiedades?populate=FotoPrincipal")).json();l.value=e.data.map(t=>({...t,documentId:t.documentId}))}catch(a){console.error("Error al cargar propiedades:",a)}}),(a,e)=>(p(),m("div",V,[e[2]||(e[2]=i("h1",null,"Propiedades",-1)),i("div",G,[(p(!0),m(x,null,T(l.value,t=>(p(),m("div",{key:t.documentId,class:"card-wrap"},[n(d(D),{hoverable:""},{cover:s(()=>[o(t)?(p(),m("img",{key:0,src:o(t),alt:"Foto principal",width:"900",height:"400"},null,8,L)):B("",!0)]),header:s(()=>[i("span",null,C(t.Titulo||"Cargando título..."),1)]),default:s(()=>[i("p",null,C(t.Descripcion||"Cargando descripcion..."),1)]),action:s(()=>[i("div",z,[n(d(w),{type:"primary",onClick:h=>f(t)},{icon:s(()=>[n(j,{name:J})]),default:s(()=>[e[1]||(e[1]=g(" Editar "))]),_:2},1032,["onClick"])])]),_:2},1024)]))),128))]),n(S,{show:u.value,propiedad:c.value,"onUpdate:show":e[0]||(e[0]=t=>u.value=t),onGuardar:r},null,8,["show","propiedad"])]))}}),Q=F(O,[["__scopeId","data-v-7a16b404"]]);export{Q as default};
