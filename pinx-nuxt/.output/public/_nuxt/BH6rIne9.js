import{d as k,r as v,E,i as N,a as c,w as s,b as n,g as i,u as d,B as h,f as g,x as P,o as b,c as m,F as x,e as T,h as j,t as C,p as B,N as D,_ as F}from"./CFnCIwgc.js";import{N as $}from"./ukkJLpdT.js";import"./blwfaMt5.js";import"./D2atxefA.js";const U={class:"space-y-4"},M={class:"flex justify-end gap-2 mt-4"},S=k({__name:"ModalEditarPropiedad",props:{show:{type:Boolean},propiedad:{}},emits:["update:show","guardar"],setup(y,{emit:l}){const u=y,p=l,o=v({});E(()=>u.propiedad,r=>{o.value={...r}},{immediate:!0});async function f(){try{if(!(await fetch(`https://admin.triplotrip.com/api/propiedades/${o.value.documentId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:{Titulo:o.value.Titulo,Descripcion:o.value.Descripcion}})})).ok)throw new Error("Error al guardar en Strapi");const e=await(await fetch(`https://admin.triplotrip.com/api/propiedades/${o.value.documentId}?populate=FotoPrincipal`)).json(),t={...e.data,...e.data.attributes,documentId:o.value.documentId};p("guardar",t),p("update:show",!1)}catch(r){console.error("Error al guardar cambios:",r)}}return(r,a)=>(c(),N(d(P),{show:r.show,preset:"dialog",title:"Editar Propiedad","onUpdate:show":a[3]||(a[3]=e=>r.$emit("update:show",e))},{action:s(()=>[n("div",M,[i(d(h),{onClick:a[2]||(a[2]=e=>r.$emit("update:show",!1))},{default:s(()=>a[4]||(a[4]=[g("Cancelar")])),_:1}),i(d(h),{type:"primary",onClick:f},{default:s(()=>a[5]||(a[5]=[g("Guardar")])),_:1})])]),default:s(()=>[n("div",U,[i(d($),{value:o.value.Titulo,"onUpdate:value":a[0]||(a[0]=e=>o.value.Titulo=e),placeholder:"Título"},null,8,["value"]),i(d($),{value:o.value.Descripcion,"onUpdate:value":a[1]||(a[1]=e=>o.value.Descripcion=e),type:"textarea",placeholder:"Descripción",rows:"4"},null,8,["value"])])]),_:1},8,["show"]))}}),V={class:"page"},G={class:"masonry"},L=["src"],z={class:"flex items-center justify-between"},J="tabler:edit",O=k({__name:"Propiedades",setup(y){const l=v([]),u=v(!1),p=v(null);function o(a){var t,w,_,I;const e=((_=(w=(t=a.FotoPrincipal)==null?void 0:t.formats)==null?void 0:w.medium)==null?void 0:_.url)||((I=a.FotoPrincipal)==null?void 0:I.url);return e?`https://admin.triplotrip.com${e}`:null}function f(a){p.value=a,u.value=!0}function r(a){const e=l.value.findIndex(t=>t.documentId===a.documentId);e!==-1&&(l.value[e]={...a})}return b(async()=>{try{const e=await(await fetch("https://admin.triplotrip.com/api/propiedades?populate=FotoPrincipal")).json();l.value=e.data.map(t=>({...t,documentId:t.documentId}))}catch(a){console.error("Error al cargar propiedades:",a)}}),(a,e)=>(c(),m("div",V,[e[2]||(e[2]=n("h1",null,"Propiedades",-1)),n("div",G,[(c(!0),m(x,null,T(l.value,t=>(c(),m("div",{key:t.documentId,class:"card-wrap"},[i(d(D),{hoverable:""},{cover:s(()=>[o(t)?(c(),m("img",{key:0,src:o(t),alt:"Foto principal",width:"900",height:"400"},null,8,L)):B("",!0)]),header:s(()=>[n("span",null,C(t.Titulo||"Cargando título..."),1)]),default:s(()=>[n("p",null,C(t.Descripcion||"Cargando descripcion..."),1)]),action:s(()=>[n("div",z,[i(d(h),{type:"primary",onClick:w=>f(t)},{icon:s(()=>[i(j,{name:J})]),default:s(()=>[e[1]||(e[1]=g(" Editar "))]),_:2},1032,["onClick"])])]),_:2},1024)]))),128))]),i(S,{show:u.value,propiedad:p.value,"onUpdate:show":e[0]||(e[0]=t=>u.value=t),onGuardar:r},null,8,["show","propiedad"])]))}}),Q=F(O,[["__scopeId","data-v-d62a2cc2"]]);export{Q as default};
