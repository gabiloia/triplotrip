import{E as g,G as A,d as V,H as $,I as L,y as R,J as F,o as m,c as u,e as a,w as c,u as e,a as t,B as C,_ as v,n as D,F as j,r as S,K as k,C as O,t as I,L as P,s as T,M as w,f as E}from"./BboPWEKj.js";import{S as G}from"./DSzRc7-S.js";import{u as q}from"./IY7XPjKL.js";import{f as i}from"./GaUcJ0Yz.js";import{N as J}from"./CgLubrXp.js";import{N}from"./DawznoV1.js";import"./DxKG17RJ.js";import"./CQhb659Y.js";import"./CBN863Oo.js";import"./DqYVDO9Y.js";function K(){const r=[],h=[];for(let n=0;n<15;n++)r.push({id:i.string.nanoid(),name:i.person.fullName(),jobTitle:i.person.jobTitle(),avatar:i.image.avatarGitHub(),online:i.datatype.boolean(),lastDate:g().toDate(),lastDateText:"",lastMessage:""});const s=r.pop();for(const n of r){const l=[];for(let x=0;x<15;x++){const p=i.datatype.boolean(),M=p?s:n,d=M.id;l.push({id:i.string.nanoid(),isMine:p,userId:d,userObj:M,messages:i.helpers.uniqueArray(i.word.sample,i.number.int({min:1,max:3})).map(()=>({text:i.lorem.sentence(i.number.int({min:2,max:10})).slice(0,-1)})),date:i.date.between({from:g().subtract(2,"w").toDate(),to:g().toDate()})})}const b=l.sort((x,p)=>x.date.getTime()-p.date.getTime()),f=b[l.length-1].date,z=b[l.length-1].messages[0].text;h.push({id:i.string.nanoid(),userId:n.id,userObj:n,conversation:b,lastDate:f}),n.lastDate=f,n.lastDateText=g(f).format("YYYY-MM-DD")===g().format("YYYY-MM-DD")?g(f).format("HH:mm"):g(f).format("D MMM"),n.lastMessage=z}return{contacts:r.sort((n,l)=>l.lastDate.getTime()-n.lastDate.getTime()),chat:h.sort((n,l)=>l.lastDate.getTime()-n.lastDate.getTime()),me:s}}const U=A("chat",{state:()=>{const{contacts:r,chat:h,me:s}=K(),n=h[0].id||"";return{contacts:r,chat:h,me:s,chatId:n}},actions:{setActiveChat(r){const h=this.chat.find(s=>s.userId===r.id)?.id;this.chatId=h||""}},getters:{activeChat(){return this.chat.find(r=>r.id===this.chatId)||null}}}),W={class:"page page-wrapped page-mobile-full page-without-footer flex flex-col"},Q={class:"search-box"},X={class:"contacts-list"},Z=["onClick"],ee={class:"u-info flex grow flex-col"},te={class:"u-title flex items-center justify-between"},ae={class:"u-name grow"},se={class:"u-date"},oe={class:"u-message"},ne={key:0,class:"toolbar"},ie={class:"user-info flex grow items-center"},ce={class:"u-info flex flex-col"},re={class:"u-name"},le={class:"u-job"},de={class:"actions-btns flex items-center gap-4 opacity-50"},me={class:"menu-btn flex justify-center opacity-50"},ue={key:0,class:"chat-view grow"},he={class:"max-h-full"},fe={class:"avatar"},pe={class:"messages-group flex flex-col"},ve={class:"date"},_e={key:1,class:"empty-view flex grow flex-col items-center justify-center"},ge={key:0,class:"message-editor flex"},be={class:"text-input grow"},xe={class:"actions-group flex items-center"},ye="carbon:chat",Ce="carbon:trash-can",Ie="carbon:overflow-menu-horizontal",we="carbon:search",B="carbon:video",H="carbon:phone",Me="carbon:information",De="fluent:alert-off-16-regular",ke="tabler:user-off",Te="carbon:microphone",ze="carbon:attachment",je="carbon:send",Se=V({__name:"Chat",setup(r){const h=$(),s=U(),n=T(null),l=T(null),b=T(null),f=T([]);function z(d){l.value=d,b.value=d.mainScrollbar}L(n,d=>{const _=d[0],{width:o}=_.contentRect,y=[{label:"Block",key:"Block",icon:w(ke)},{label:"Mute",key:"Mute",icon:w(De)},{label:"Info",key:"Info",icon:w(Me)},{label:"Delete",key:"Delete",icon:w(Ce)}],Y=[{label:"Video",key:"Video",icon:w(B)},{label:"Call",key:"Call",icon:w(H)}];o<400?f.value=[...Y,...y]:f.value=y});function x(d){l.value?.closeSidebar?.(),s.setActiveChat(d),p()}function p(){setTimeout(()=>{b.value?.scrollTo({position:"bottom"})},50)}function M(){window.scrollTo(0,0)}return R(()=>{p(),F(()=>{const d=1e3*h.routerTransitionDuration;setTimeout(()=>{p()},d+500)})}),q(),(d,_)=>(m(),u("div",W,[a(G,{"sidebar-content-class":"p-0!","enable-resize":"",onMounted:z},{"sidebar-header":c(()=>[t("div",Q,[a(e(N),{placeholder:"Search...",clearable:"",size:"medium"},{prefix:c(()=>[a(v,{name:we})]),_:1})])]),"sidebar-content":c(()=>[t("div",X,[(m(!0),u(j,null,S(e(s).contacts,o=>(m(),u("div",{key:o.id,class:k(["user flex items-center",{"u-active":o.id===e(s).activeChat?.userId}]),onClick:y=>x(o)},[t("div",{class:k(["u-avatar flex items-center",{"u-online":o.online}])},[a(e(O),{round:"",size:"large",src:o.avatar,"img-props":{alt:`${o.name}-avatar`}},null,8,["src","img-props"])],2),t("div",ee,[t("div",te,[t("div",ae,I(o.name),1),t("div",se,I(o.lastDateText),1)]),t("div",oe,I(o.lastMessage),1)])],10,Z))),128))])]),"main-toolbar":c(()=>[e(s).activeChat?(m(),u("div",ne,[t("div",ie,[t("div",{class:k(["u-avatar flex items-center",{"u-online":e(s).activeChat.userObj.online}])},[a(e(O),{round:"",size:"large",src:e(s).activeChat.userObj.avatar,"img-props":{alt:`${e(s).activeChat.userObj.name}-avatar`}},null,8,["src","img-props"])],2),t("div",ce,[t("div",re,I(e(s).activeChat.userObj.name),1),t("div",le,I(e(s).activeChat.userObj.jobTitle),1)])]),t("div",de,[a(e(C),{text:""},{default:c(()=>[a(v,{name:B,size:20})]),_:1}),a(e(C),{text:""},{default:c(()=>[a(v,{name:H,size:20})]),_:1})]),t("div",me,[a(e(P),{options:f.value},{default:c(()=>[a(e(C),{text:""},{default:c(()=>[a(v,{name:Ie,size:24})]),_:1})]),_:1},8,["options"])])])):D("",!0)]),"main-content":c(()=>[t("div",{ref_key:"main",ref:n,class:"main"},[e(s).activeChat?(m(),u("div",ue,[t("div",he,[(m(!0),u(j,null,S(e(s).activeChat.conversation,o=>(m(),u("div",{key:o.id,class:k(["conversation item-appear item-appear-bottom item-appear-010 flex",{mine:o.isMine}])},[t("div",fe,[a(e(O),{round:"",size:"large",src:o.userObj.avatar,"img-props":{alt:`${o.userObj.name}-avatar`}},null,8,["src","img-props"])]),t("div",pe,[(m(!0),u(j,null,S(o.messages,y=>(m(),u("div",{key:y.text,class:"message"},I(y.text),1))),128)),t("div",ve,[a(e(J),{time:o.date,format:"d MMM @ HH:mm"},null,8,["time"])])])],2))),128))])])):D("",!0),e(s).activeChat?D("",!0):(m(),u("div",_e,[a(v,{name:ye,size:48}),_[1]||(_[1]=t("div",{class:"mt-4 text-xl"},"Select a Contact",-1))]))],512)]),"main-footer":c(()=>[e(s).activeChat?(m(),u("div",ge,[t("div",be,[a(e(N),{placeholder:"Message...",type:"textarea",size:"small",autosize:{minRows:1,maxRows:5},onBlur:_[0]||(_[0]=o=>M())})]),t("div",xe,[a(e(C),{text:""},{default:c(()=>[a(v,{name:Te,size:20})]),_:1}),a(e(C),{text:""},{default:c(()=>[a(v,{name:ze,size:20})]),_:1}),a(e(C),{strong:"",ghost:"",circle:"",type:"primary"},{default:c(()=>[a(v,{name:je,size:20})]),_:1})])])):D("",!0)]),_:1})]))}}),Fe=E(Se,[["__scopeId","data-v-ad50fb30"]]);export{Fe as default};
