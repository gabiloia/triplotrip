import{E as b,G as A,d as V,H as $,q as D,I as L,y as R,J as F,c as u,o as h,e as s,w as r,l as k,u as e,a as t,B as C,_ as g,F as j,r as S,K as T,C as O,t as I,L as P,M as w,f as q}from"./Cc935Wq4.js";import{S as E}from"./B7OhDaE0.js";import{u as G}from"./BOu3dVEQ.js";import{f as c}from"./BUrEn1b-.js";import{N as J}from"./DU8xB7QA.js";import{N as B}from"./78yQ6ZAJ.js";import"./DcMmf2sx.js";import"./C5dGXucr.js";import"./n7hhwT1A.js";import"./B0PnIP4q.js";function K(){const d=[],f=[];for(let n=0;n<15;n++)d.push({id:c.string.nanoid(),name:c.person.fullName(),jobTitle:c.person.jobTitle(),avatar:c.image.avatarGitHub(),online:c.datatype.boolean(),lastDate:b().toDate(),lastDateText:"",lastMessage:""});const o=d.pop();for(const n of d){const m=[];for(let y=0;y<15;y++){const v=c.datatype.boolean(),M=v?o:n,i=M.id;m.push({id:c.string.nanoid(),isMine:v,userId:i,userObj:M,messages:c.helpers.uniqueArray(c.word.sample,c.number.int({min:1,max:3})).map(()=>({text:c.lorem.sentence(c.number.int({min:2,max:10})).slice(0,-1)})),date:c.date.between({from:b().subtract(2,"w").toDate(),to:b().toDate()})})}const x=m.sort((y,v)=>y.date.getTime()-v.date.getTime()),p=x[m.length-1].date,z=x[m.length-1].messages[0].text;f.push({id:c.string.nanoid(),userId:n.id,userObj:n,conversation:x,lastDate:p}),n.lastDate=p,n.lastDateText=b(p).format("YYYY-MM-DD")===b().format("YYYY-MM-DD")?b(p).format("HH:mm"):b(p).format("D MMM"),n.lastMessage=z}return{contacts:d.sort((n,m)=>m.lastDate.getTime()-n.lastDate.getTime()),chat:f.sort((n,m)=>m.lastDate.getTime()-n.lastDate.getTime()),me:o}}const U=A("chat",{state:()=>{const{contacts:d,chat:f,me:o}=K(),n=f[0].id||"";return{contacts:d,chat:f,me:o,chatId:n}},actions:{setActiveChat(d){var o;const f=(o=this.chat.find(n=>n.userId===d.id))==null?void 0:o.id;this.chatId=f||""}},getters:{activeChat(){return this.chat.find(d=>d.id===this.chatId)||null}}}),W={class:"page page-wrapped page-mobile-full page-without-footer flex flex-col"},Q={class:"search-box"},X={class:"contacts-list"},Z=["onClick"],ee={class:"u-info flex grow flex-col"},te={class:"u-title flex items-center justify-between"},ae={class:"u-name grow"},se={class:"u-date"},oe={class:"u-message"},ne={key:0,class:"toolbar"},ie={class:"user-info flex grow items-center"},ce={class:"u-info flex flex-col"},re={class:"u-name"},le={class:"u-job"},de={class:"actions-btns flex items-center gap-4 opacity-50"},me={class:"menu-btn flex justify-center opacity-50"},ue={key:0,class:"chat-view grow"},he={class:"max-h-full"},fe={class:"avatar"},pe={class:"messages-group flex flex-col"},ve={class:"date"},_e={key:1,class:"empty-view flex grow flex-col items-center justify-center"},ge={key:0,class:"message-editor flex"},be={class:"text-input grow"},xe={class:"actions-group flex items-center"},ye="carbon:chat",Ce="carbon:trash-can",Ie="carbon:overflow-menu-horizontal",we="carbon:search",H="carbon:video",Y="carbon:phone",Me="carbon:information",De="fluent:alert-off-16-regular",ke="tabler:user-off",Te="carbon:microphone",ze="carbon:attachment",je="carbon:send",Se=V({__name:"Chat",setup(d){const f=$(),o=U(),n=D(null),m=D(null),x=D(null),p=D([]);function z(i){m.value=i,x.value=i.mainScrollbar}L(n,i=>{const l=i[0],{width:a}=l.contentRect,_=[{label:"Block",key:"Block",icon:w(ke)},{label:"Mute",key:"Mute",icon:w(De)},{label:"Info",key:"Info",icon:w(Me)},{label:"Delete",key:"Delete",icon:w(Ce)}],N=[{label:"Video",key:"Video",icon:w(H)},{label:"Call",key:"Call",icon:w(Y)}];a<400?p.value=[...N,..._]:p.value=_});function y(i){var l,a;(a=(l=m.value)==null?void 0:l.closeSidebar)==null||a.call(l),o.setActiveChat(i),v()}function v(){setTimeout(()=>{var i;(i=x.value)==null||i.scrollTo({position:"bottom"})},50)}function M(){window.scrollTo(0,0)}return R(()=>{v(),F(()=>{const i=1e3*f.routerTransitionDuration;setTimeout(()=>{v()},i+500)})}),G(),(i,l)=>(h(),u("div",W,[s(E,{"sidebar-content-class":"p-0!","enable-resize":"",onMounted:z},{"sidebar-header":r(()=>[t("div",Q,[s(e(B),{placeholder:"Search...",clearable:"",size:"medium"},{prefix:r(()=>[s(g,{name:we})]),_:1})])]),"sidebar-content":r(()=>[t("div",X,[(h(!0),u(j,null,S(e(o).contacts,a=>{var _;return h(),u("div",{key:a.id,class:T(["user flex items-center",{"u-active":a.id===((_=e(o).activeChat)==null?void 0:_.userId)}]),onClick:N=>y(a)},[t("div",{class:T(["u-avatar flex items-center",{"u-online":a.online}])},[s(e(O),{round:"",size:"large",src:a.avatar,"img-props":{alt:`${a.name}-avatar`}},null,8,["src","img-props"])],2),t("div",ee,[t("div",te,[t("div",ae,I(a.name),1),t("div",se,I(a.lastDateText),1)]),t("div",oe,I(a.lastMessage),1)])],10,Z)}),128))])]),"main-toolbar":r(()=>[e(o).activeChat?(h(),u("div",ne,[t("div",ie,[t("div",{class:T(["u-avatar flex items-center",{"u-online":e(o).activeChat.userObj.online}])},[s(e(O),{round:"",size:"large",src:e(o).activeChat.userObj.avatar,"img-props":{alt:`${e(o).activeChat.userObj.name}-avatar`}},null,8,["src","img-props"])],2),t("div",ce,[t("div",re,I(e(o).activeChat.userObj.name),1),t("div",le,I(e(o).activeChat.userObj.jobTitle),1)])]),t("div",de,[s(e(C),{text:""},{default:r(()=>[s(g,{name:H,size:20})]),_:1}),s(e(C),{text:""},{default:r(()=>[s(g,{name:Y,size:20})]),_:1})]),t("div",me,[s(e(P),{options:p.value},{default:r(()=>[s(e(C),{text:""},{default:r(()=>[s(g,{name:Ie,size:24})]),_:1})]),_:1},8,["options"])])])):k("",!0)]),"main-content":r(()=>[t("div",{ref_key:"main",ref:n,class:"main"},[e(o).activeChat?(h(),u("div",ue,[t("div",he,[(h(!0),u(j,null,S(e(o).activeChat.conversation,a=>(h(),u("div",{key:a.id,class:T(["conversation item-appear item-appear-bottom item-appear-010 flex",{mine:a.isMine}])},[t("div",fe,[s(e(O),{round:"",size:"large",src:a.userObj.avatar,"img-props":{alt:`${a.userObj.name}-avatar`}},null,8,["src","img-props"])]),t("div",pe,[(h(!0),u(j,null,S(a.messages,_=>(h(),u("div",{key:_.text,class:"message"},I(_.text),1))),128)),t("div",ve,[s(e(J),{time:a.date,format:"d MMM @ HH:mm"},null,8,["time"])])])],2))),128))])])):k("",!0),e(o).activeChat?k("",!0):(h(),u("div",_e,[s(g,{name:ye,size:48}),l[1]||(l[1]=t("div",{class:"mt-4 text-xl"},"Select a Contact",-1))]))],512)]),"main-footer":r(()=>[e(o).activeChat?(h(),u("div",ge,[t("div",be,[s(e(B),{placeholder:"Message...",type:"textarea",size:"small",autosize:{minRows:1,maxRows:5},onBlur:l[0]||(l[0]=a=>M())})]),t("div",xe,[s(e(C),{text:""},{default:r(()=>[s(g,{name:Te,size:20})]),_:1}),s(e(C),{text:""},{default:r(()=>[s(g,{name:ze,size:20})]),_:1}),s(e(C),{strong:"",ghost:"",circle:"",type:"primary"},{default:r(()=>[s(g,{name:je,size:20})]),_:1})])])):k("",!0)]),_:1})]))}}),Fe=q(Se,[["__scopeId","data-v-ad50fb30"]]);export{Fe as default};
